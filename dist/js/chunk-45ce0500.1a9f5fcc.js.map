{"version":3,"sources":["webpack:///./src/components/user/login.vue?c295","webpack:///./src/components/user/login.vue?2bfb","webpack:///src/components/user/login.vue","webpack:///./src/components/user/login.vue?117d","webpack:///./src/components/user/login.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_login_vue_vue_type_style_index_0_id_2949f31e_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_10_oneOf_1_0_node_modules_css_loader_index_js_ref_10_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_10_oneOf_1_2_node_modules_less_loader_dist_cjs_js_ref_10_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_login_vue_vue_type_style_index_0_id_2949f31e_lang_less_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","$store","getters","checkLogin","expression","staticClass","attrs","src","alt","_v","title","_f","userInfo","avatar","on","click","getRecommend","domProps","innerHTML","_s","nickName","size","level","userId","ref","status-icon","label-position","label-width","label","autocomplete","model","callback","$$v","account","type","password","$event","preventDefault","login","staticRenderFns","loginvue_type_script_lang_js_","data","token","friends","getUserInfo","checkFlag","txt","logFlag","showInfo","recommendInfo","methods","_login","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","res","wrap","_context","prev","next","localStorage","getItem","JSON","parse","commit","ajax","sent","status","abrupt","$message","error","message","content","tmp","now_default","setItem","stringify_default","setTimeout","window","location","reload","stop","apply","arguments","check","date","Date","toDateString","flag","getCheck","_getCheck","_callee2","_context2","state","_getRecommend","_callee3","_context3","$router","push","params","id","mounted","computed","objectSpread","vuex_esm","user_loginvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-45ce0500.1a9f5fcc.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=2949f31e&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=style&index=0&id=2949f31e&lang=less&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!this.$store.getters.checkLogin),expression:\"!this.$store.getters.checkLogin\"}],staticClass:\"logo\"},[_c('img',{attrs:{\"src\":require(\"../../assets/images/login_logo.png\"),\"alt\":\"\"}}),_c('p',{staticClass:\"brand\"},[_vm._v(\"口袋48\")])]),(!this.$store.getters.checkLogin)?_c('div',{staticClass:\"login-container\"},[_c('el-form',{ref:\"ruleForm2\",staticClass:\"demo-ruleForm\",attrs:{\"status-icon\":\"\",\"label-position\":\"top\",\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"手机：\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.account),callback:function ($$v) {_vm.account=$$v},expression:\"account\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}})],1),_c('el-form-item',{staticClass:\"button\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){$event.preventDefault();return _vm.login($event)}}},[_vm._v(\"登录\")]),_c('el-button',[_vm._v(\"重置\")])],1)],1)],1):_c('div',{staticClass:\"user-info my-card\"},[_c('img',{attrs:{\"title\":\"点击查看更多信息\",\"src\":_vm._f(\"picPathFormat\")(_vm.userInfo.avatar),\"alt\":\"\"},on:{\"click\":_vm.getRecommend}}),_c('div',{staticClass:\"extra-info\"},[_c('p',[_c('span',{staticClass:\"user-name\",domProps:{\"innerHTML\":_vm._s(_vm.userInfo.nickName)}}),_c('el-tag',{attrs:{\"size\":\"mini\"},domProps:{\"innerHTML\":_vm._s('lv.'+_vm.userInfo.level)}})],1),_c('p',{domProps:{\"innerHTML\":_vm._s('ID: '+_vm.userInfo.userId)}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"logo\" v-show=\"!this.$store.getters.checkLogin\">\r\n      <img src=\"../../assets/images/login_logo.png\" alt=\"\">\r\n      <p class=\"brand\">口袋48</p>\r\n    </div>\r\n      <div class=\"login-container\" v-if=\"!this.$store.getters.checkLogin\">\r\n        <el-form \r\n          status-icon ref=\"ruleForm2\"\r\n          label-position=\"top\"\r\n          label-width=\"100px\" class=\"demo-ruleForm\"\r\n        >\r\n          <el-form-item label=\"手机：\">\r\n            <el-input autocomplete=\"off\" v-model=\"account\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"密码\">\r\n            <el-input type=\"password\" v-model=\"password\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item class=\"button\">\r\n            <el-button type=\"primary\" @click.prevent=\"login\">登录</el-button>\r\n            <el-button>重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    <div v-else class=\"user-info my-card\">\r\n      <img title=\"点击查看更多信息\" :src=\"userInfo.avatar | picPathFormat\" alt=\"\" @click=\"getRecommend\">\r\n      <!-- <div class=\"check\">\r\n        <el-button @click=\"getCheck\" :type=\"type\" size=\"mini\" :disabled=\"checkFlag\" v-html=\"txt\"></el-button>\r\n      </div> -->\r\n      <div class=\"extra-info\">\r\n        <p>\r\n          <span v-html=\"userInfo.nickName\" class=\"user-name\"></span>\r\n          <el-tag size=\"mini\" v-html=\"'lv.'+userInfo.level\"></el-tag>\r\n        </p>\r\n        <p v-html=\"'ID: '+userInfo.userId\"></p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex'\r\n  export default {\r\n    name: \"login\",\r\n    data() {\r\n      return {\r\n        account: '',\r\n        password: '',\r\n        token: '',\r\n        friends: [],\r\n        userInfo: this.$store.getters.getUserInfo,\r\n        type: 'danger',\r\n        checkFlag: false,\r\n        txt: '打卡',\r\n        logFlag: this.$store.getters.checkLogin,\r\n        showInfo: false,\r\n        recommendInfo: false\r\n      }\r\n    },\r\n    methods: {\r\n      async login(){ // 登录\r\n        if(localStorage.getItem('userinfo')){ // 非第一次登录\r\n          let userInfo = JSON.parse(localStorage.getItem('userinfo'))\r\n          this.$store.commit('saveUserInfo',userInfo.userInfo)\r\n          this.token = userInfo.token\r\n          this.$store.commit('setToken', userInfo.token)\r\n          this.friends = userInfo.friends\r\n        }else{ // 第一次登陆，存储用户信息\r\n          const res = await this.ajax('/login',{account: this.account,password: this.password},'POST')\r\n          if(res.status === 1001003) return this.$message.error(res.message)\r\n          this.password = ''\r\n          this.account = ''\r\n          this.userInfo = res.content.userInfo\r\n          res.content.tmp = Date.now()\r\n          this.$store.commit('saveUserInfo',this.userInfo)\r\n          this.token = res.content.token\r\n          this.$store.commit('setToken', this.token)\r\n          this.logFlag = true\r\n          localStorage.setItem('isLogin',JSON.stringify({logFlag: this.logFlag}))\r\n          this.userInfo.friends = []\r\n          localStorage.setItem('userinfo', JSON.stringify(res.content))\r\n          this.$message('登陆成功，3秒后刷新')\r\n          setTimeout(() => {\r\n            window.location.reload()\r\n          },3000)\r\n        }\r\n      },\r\n      check(){\r\n        if(!localStorage.getItem('isLogin')){ // 打卡签到\r\n          return\r\n        }\r\n        let date = new Date().toDateString()\r\n        let flag = JSON.parse(localStorage.getItem('isLogin'))\r\n        if (flag.date && flag.date === date){\r\n          this.checkFlag = true\r\n          this.txt= '已打卡'\r\n        }else{\r\n          this.checkFlag = false\r\n        }\r\n      },\r\n      async getCheck(){ // 检查是否已打卡签到\r\n        const res = await this.ajax('/getCheck',{token:this.$store.state.token},'POST')\r\n        if (res.status===200 || res.status===1001006){\r\n          let flag = JSON.parse(localStorage.getItem('isLogin'))\r\n          flag.checkFlag = true\r\n          flag.date = new Date().toDateString()\r\n          localStorage.setItem('isLogin',JSON.stringify(flag))\r\n          this.checkFlag = true\r\n          this.txt= '已打卡'\r\n          this.$message(res.message)\r\n        }else{\r\n          return this.$message.error('请稍后再试')\r\n        }\r\n      },\r\n      async getRecommend(){\r\n        this.$router.push({\r\n          name: 'userinfo',\r\n          params: {\r\n            id: this.userInfo.userId,\r\n          }\r\n        })\r\n      },\r\n    },\r\n    mounted() {\r\n      this.check()\r\n    },\r\n    computed: {\r\n      ...mapState(['jujuInfo']) \r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '../../assets/less/global';\r\n  .logo{\r\n    .flex-all-center();\r\n    width: 100%;\r\n    padding-top: 10px;\r\n    img{\r\n      width: 50px;\r\n      height: 50px;\r\n      margin-right: 10px;\r\n    }\r\n    .brand{\r\n      font-size: 30px;\r\n    }\r\n  }\r\n.login-container{\r\n  .flex-justify-center();\r\n  padding: 10px;\r\n  .el-form{\r\n    .el-form-item{\r\n      width: 300px;\r\n      .el-form-item__content{\r\n        .el-input{\r\n          .el-input__inner{\r\n            width: 200px!important;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .button{\r\n      .flex-justify-center();\r\n    }\r\n  }\r\n}\r\n.user-info{\r\n  text-align: center;\r\n  padding: 10px;\r\n  margin: 5px;\r\n  img{\r\n    width: 80px;\r\n    height: 80px;\r\n    cursor: pointer;\r\n    border-radius: 50%;\r\n    border: 2px solid #ccc;\r\n  }\r\n  .check{\r\n    margin-top: 5px;\r\n  }\r\n  .extra-info{\r\n    .user-name{\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n  .flex-justify-center{\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=2949f31e&scoped=true&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&id=2949f31e&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2949f31e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}